
#+TITLE: Automatic Evaluation of Machine Translation Software
* Overview
This project we are apply metamorphic testing to the evaluation of translation software. We are using round-trip translation metamorphic relation.
- Firstly, we have get test case from Wikipedia. Totally, have two category, one is single sentence, another is paragraph, which only comprise with sentences, not with list etc.
- Secondly, we have evaluation three translation tools, Youdao translation, bing translation and google translation
- Thirdly, we have using BLEU (bilingual evaluation understudy) and GMT (general text matcer) algorithm for evaluating the quality of translated text which has been using machine-translate.

* Test case
In our project, the of test cases are atomatically captured from the internet. 
We are using a dictionaries as key word put in Wikipedia search engine for get single sentence from Wikipedia.



** Wikipedia API

** Dictionary
Tushar, Shantanu (2013, pp. 219 - 220) show that WordList(Dictionary) is a standard file on all Unix and Unix-like operating systems. The wordList file is usually stored in /usr/share/dict/words or /usr/dict/words.[1]
The wordList story more than 60,000 meanful words.

In this project, an online website is applied to obatin the dictionary which has generated the wordlist programmed by stndards Unix tools.[2]
Due to the result to be catched in python will be a list-structure ASCII, the reuslt needs to be post-edited with spliting into individual words for using.   

** Get test case
To be make to result valid and accurate, the size test-semaple is supposed to be large enough. 
Considerd about the size of our group and the tools we have, the quatity of the testing sample is decided to be 1000 sentences.
In the dictionary there are near 70 thousands words , therefore, we generate a list of random numbers as word-obtaining indexes. 
In case some words may not be able to match the paragraph correctly(that regrad as exception, will discuss later), the quantity of it will be approximately as twice as the test sample size(1000) which is about 2000.
The approach  to get the random number is that: Firstly set a interval calculated by (size of dictionary /size of test sample)/2. 
Then randomly select one number out of each interval-size range. Thus the random number list described above can be generated.
When the program starts running, it will keep counting until 1000 valid ones has been selected as the indexes of wordlist to get the corrsponding words.
  

The specific steps are:
- Traverse each key word from Dictionary by the the random index.
- Put the key word into Wikipedia search engine(we have using Wikipedia APi)
- Search summary part of this key word in Wikipedia.
- If this key word have not recored in Wikipedia, We will be ingnore it, traverse the next key word(The specific method will discuss later).
- If have result, all of summary paragraph will be snatched.
- Since the paragraph we get is in list structure of senctences, the first sentence of the summary paragraph will be splited out as a test case.

Exception Solution:
As motioned above, there will be some words do not have the summary part or even not exist in wikipidia. 
Thus we use an exception to deal with such cases so that the programme will jump over this incorrect search without recording and move to the next search.
It is  also necessary to eliminate the empty entry situation with a conditianal judging statement.
For every word, all the secntences that have been obtained will be written into excel file as the results for the further translation and evalutaion.

To get and print the wordlist:
The wordlist will be obtained automatically which will be uesed for getting the sentence test cases。
Firstly, it will ask if the user want to print the wordlist out beccause the word itself is not the test object.
However that will make it more for the testers clear about where the test sentences come from. As a result, printing out the wordlist is optional.
When the user choose to print it out, all the indexes the words that has valid paragraph searching are recorded and they will be used to get and print out all the words. 




*Merge the transaltion result
The test data sample has been divided to several parts for transalting in order to increase the efficiency of the work. 
After the translation, different translated parts will be merged together into one excel file row by row with the identical order of the orginal test data sample
It is an atomatic procedure through a program 

*Vadliate the translation result
The ultimate prodeuced excel file includes the orginal English senteces and the translation results of other eight laugnages(zh-CHS', 'ja', 'ko', 'fr', 'ru', 'pt', 'es', 'sv').
One sentence is for a row and one language is for a column.
For each sentence, the transaltion will be regards as invalid only if the transaltion result of every lauguage is invalid(which means empty in contents).
In the way the program will make a judegment for each row so that the ones that has successful translation for at least one language will be kept.
Ohterwise, the whole row will be set as empty.

To check the validity of 

* translate tool
** youdao translate
Youdao (有道) is a search engine released by Chinese internet company NetEase (網易).
This search engine not only support English and Chinese. Also can support lots of others language.
language spuuort list:
| language   | code   |
|------------+--------|
| Chinese    | zh-CHS |
| Japanese   | ja     |
| English    | EN     |
| Korean     | ko     |
| French     | fr     |
| Russion    | ru     |
| Portuguese | pt     |
| Spanish    | es     |
*** Create account, get application key and password
When you want to using youdao api for translation, First, you must creat a account in YOUDAO ZHI YUN. THis is link http://ai.youdao.com .
I have choose using my wechat to login ZHI YUN. Because, each time when I log in. I only need scan QR code in my wechat for convenience.
After you need do some set up for get appKey and key, both are inportance for you send POST requie.
There is step by step
- go to application management
- click my application
- creat a new application, filed info and create
- create a translation instance and bind with you application, which is you before you have created.

When you finish all of step you can start using YOUDAO API. :)

*** Using YOUDAO API guide
This youdao translate API, we can using http or https POST to send our sample data(sentence and paragraph) to youdao and get translated data return by JSON.

youdao api http address: http://openapi.youdao.com/api
youdao api https address: https://openapi.youdao.com/api


This is a exmple for translate good(English) word to chinese's POST URL.
http://openapi.youdao.com/api?q=good&from=EN&to=zh_CHS&appKey=ff889495-4b45-46d9-8f48-946554334f2a&salt=2&sign=1995882C5064805BC30A39829B779D7B

| Field Name | type | mean                | Must filed | Comment                                                                                   |
|------------+------+---------------------+------------+-------------------------------------------------------------------------------------------|
| q          | text | want translate text | True       | must be UTF-8                                                                             |
| from       | text | from which language | True       | must in language support list(you also can set to auto)                                   |
| to         | text | target language     | True       | must in language support list(you also can set to auto)                                   |
| appKey     | text | application key     | True       | you can find in application management in youdao ZHI YUN                                  |
| salt       | text | random number       | True       |                                                                                           |
| sign       | text | signiture           | True       | MD5(appKey + q + salt + key) key you can find in application management in YOUDAO ZHI YUN |

You can get a JSON file back.
In JSON file only have two colum is importance in our system, one is errorCode, and another one is translation
If errorCode is 0 mean no error. and translation is our most inerest part is our translate result.
This is a example
{
   "errorCode": "0",
   "translation": ["大丈夫です"]
}
All of code for youdao, please have a look youdao.py in code folder
[[./img/youdaoZhiYun.png]]

** bing translate
Bing translate(Microsoft Translate) is a multilingual machine translation cloud service provided by Microsoft. Bing translator API include Text translation, Speech translation and Text to speech. However, I am only using text translation in this project.

*** Create account, get subscribe ID, get Key 1 and Key 2
This is frist step for using bing translator API.
1. sign into Azure. link https://azure.microsoft.com/en-gb/account/
   - click MY ACCOUNT
   - click AZURE portal
   - I am using my by932@uowmail.edu.au to login, I need to choose Work or school account
   - go to the Cognitive Service section
   - under API type select the Text and fill out the rest of the form and creat subscribe
   - get authentication key
     + In menu All Resources
     + click on your subscription, you can find subscription if in overview and Key 1 and Key 2 in resource management keys

[[./img/azure.png]]
[[./img/subscription.png]]

*** Using bing API guide
**** get authentication token


* Reference List
[1] Tushar, Shantanu (2013). Linux Shell Scripting Cookbook. Birmingham, UK.: Packt Publishing. pp. 219–220. ISBN 978-1-78216-275-9.
[2] An English Word List. 2017. An English Word List. [ONLINE] Available at: http://www-personal.umich.edu/~jlawler/wordlist.html. [Accessed 05 October 2017].
[3] 